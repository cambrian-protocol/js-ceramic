FROM node:16

RUN apt-get update && apt-get install -y netcat

WORKDIR /js-ceramic

COPY package.json pnpm-lock.json pnpm-workspace.yaml tsconfig.json ./

RUN pnpm install --frozen-lockfile --ignore-scripts --prod

COPY packages ./packages

COPY types ./types

RUN pnpm build

EXPOSE 7007

ENTRYPOINT ["./packages/cli/bin/ceramic.js", "daemon"]
